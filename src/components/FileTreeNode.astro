---
import type { TreeNode } from '../utils/fileTree';

interface Props {
  node: TreeNode;
  currentSlug?: string;
  depth?: number;
}

const { node, currentSlug, depth = 0 } = Astro.props;
const isActive = node.slug === currentSlug;
const base = import.meta.env.BASE_URL.endsWith('/') ? import.meta.env.BASE_URL : import.meta.env.BASE_URL + '/';
const href = `${base}posts/${node.slug}`.replace(/\/+/g, '/');
---

<div class="font-mono text-sm leading-6">
  {node.type === 'directory' ? (
    <div>
      <div class="text-blue-400 font-bold" style={`padding-left: ${depth * 1.25}rem`}>
        <span>ðŸ“‚ {node.name}</span>
      </div>
      {node.children.map((child) => (
        <Astro.self node={child} currentSlug={currentSlug} depth={depth + 1} />
      ))}
    </div>
  ) : (
    <a
      href={href}
      class:list={[
        "block hover:bg-zinc-800 transition-colors duration-200",
        isActive ? "text-green-400 font-bold bg-zinc-800" : "text-gray-400"
      ]}
      style={`padding-left: ${depth * 1.25}rem`}
    >
      <span class="mr-2">{isActive ? '>' : ' '}</span>
      ðŸ“„ {node.name}
    </a>
  )}
</div>
